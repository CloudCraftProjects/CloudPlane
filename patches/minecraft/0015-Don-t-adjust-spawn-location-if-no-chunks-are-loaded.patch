From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: booky10 <boooky10@gmail.com>
Date: Tue, 13 Aug 2024 05:30:10 +0200
Subject: [PATCH] Don't adjust spawn location if no chunks are loaded


diff --git a/net/minecraft/server/level/ServerPlayer.java b/net/minecraft/server/level/ServerPlayer.java
index e14f239f49deac016a27bbdba63df533e66e720f..fc448ecf977e1d3353773f474d5a459b4a2657b0 100644
--- a/net/minecraft/server/level/ServerPlayer.java
+++ b/net/minecraft/server/level/ServerPlayer.java
@@ -494,6 +494,7 @@ public class ServerPlayer extends Player implements ca.spottedleaf.moonrise.patc
             blockPos = pos;
         }
 
+        if (level.hasChunkAt(blockPos)) { // CloudPlane - don't adjust spawn location if no chunks are loaded
         while (!this.noCollisionNoLiquid(level, aabb.move(blockPos.getBottomCenter())) && blockPos.getY() < level.getMaxY()) {
             blockPos = blockPos.above();
         }
@@ -501,6 +502,7 @@ public class ServerPlayer extends Player implements ca.spottedleaf.moonrise.patc
         while (this.noCollisionNoLiquid(level, aabb.move(blockPos.below().getBottomCenter())) && blockPos.getY() > level.getMinY() + 1) {
             blockPos = blockPos.below();
         }
+        } // CloudPlane - don't adjust spawn location if no chunks are loaded
 
         return blockPos;
     }
