From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Kevin Raneri <kevin.raneri@gmail.com>
Date: Tue, 9 Nov 2021 23:36:56 -0500
Subject: [PATCH] Pufferfish API Buildscript Patches


diff --git a/build.gradle.kts b/build.gradle.kts
index 1606e63a1492a93e29bc9c540b5557db2d5da2aa..7891077ce12718a5585201b9a2a3475bae4b329b 100644
--- a/build.gradle.kts
+++ b/build.gradle.kts
@@ -87,6 +87,8 @@ dependencies {
     testImplementation("org.ow2.asm:asm-tree:9.8")
     mockitoAgent("org.mockito:mockito-core:5.14.1") { isTransitive = false } // configure mockito agent that is needed in newer java versions
     testRuntimeOnly("org.junit.platform:junit-platform-launcher")
+
+    api("io.sentry:sentry:7.15.0") // Pufferfish
 }
 
 val generatedDir: java.nio.file.Path = layout.projectDirectory.dir("src/generated/java").asFile.toPath()
@@ -99,6 +101,7 @@ sourceSets {
     main {
         java {
             srcDir(generatedDir)
+            srcDir("src/main/pufferfish") // Pufferfish
         }
     }
 }
@@ -146,6 +149,12 @@ val generateApiVersioningFile by tasks.registering {
     }
 }
 
+// Pufferfish start
+tasks.withType<JavaCompile> {
+    options.compilerArgs.add("--add-modules=jdk.incubator.vector")
+}
+// Pufferfish end
+
 tasks.jar {
     from(generateApiVersioningFile.map { it.outputs.files.singleFile }) {
         into("META-INF/maven/${project.group}/${project.name}")
@@ -165,6 +174,7 @@ val services = objects.newInstance<Services>()
 
 tasks.withType<Javadoc>().configureEach {
     val options = options as StandardJavadocDocletOptions
+    options.addStringOption("-add-modules", "jdk.incubator.vector") // Pufferfish
     options.overview = "src/main/javadoc/overview.html"
     options.use()
     options.isDocFilesSubDirs = true
