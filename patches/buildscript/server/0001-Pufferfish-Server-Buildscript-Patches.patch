From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Kevin Raneri <kevin.raneri@gmail.com>
Date: Tue, 9 Nov 2021 23:36:56 -0500
Subject: [PATCH] Pufferfish Server Buildscript Patches


diff --git a/build.gradle.kts b/build.gradle.kts
index 6449d21421346fc077dc10cbbf246fbc926825df..64ecba84aef540c9d9b1f3ed9aa5106520dfc3c8 100644
--- a/build.gradle.kts
+++ b/build.gradle.kts
@@ -104,6 +104,16 @@ if (project.providers.gradleProperty("publishDevBundle").isPresent) {
     }
 }
 
+// Pufferfish start
+sourceSets {
+    main {
+        java {
+            srcDir("src/main/pufferfish")
+        }
+    }
+}
+// Pufferfish end
+
 val log4jPlugins = sourceSets.create("log4jPlugins")
 configurations.named(log4jPlugins.compileClasspathConfigurationName) {
     extendsFrom(configurations.compileClasspath.get())
@@ -162,6 +172,8 @@ dependencies {
         isTransitive = false // includes junit
     }
 
+    implementation("com.github.technove:Flare:34637f3f87") // Pufferfish - flare
+
     testImplementation("io.github.classgraph:classgraph:4.8.179") // For mob goal test
     testImplementation("org.junit.jupiter:junit-jupiter:5.12.2")
     testImplementation("org.junit.platform:junit-platform-suite-engine:1.12.2")
@@ -185,6 +197,13 @@ dependencies {
     implementation("me.lucko:spark-paper:1.10.152")
 }
 
+// Pufferfish start
+tasks.withType<JavaCompile> {
+    val compilerArgs = options.compilerArgs
+    compilerArgs.add("--add-modules=jdk.incubator.vector")
+}
+// Pufferfish end
+
 tasks.jar {
     manifest {
         val git = Git(rootProject.layout.projectDirectory.path)
